<div class="container">
  <div class="row">
  <%= image_tag @post.image, width: '600px' %>
  <br>  
  標題：<%= @post.title %>
  <br>
  內容：<%= @post.content %>
  <br>
  作者：<%= @post.user.name %>
     
  <% if not current_user == @post.user %>

    <% if current_user.friend?(@post.user) %>

    <% elsif current_user.request_friend?(@post.user) %>
      <%= link_to '取消好友邀請', friendship_path(@post.user), method: :delete, class: "btn btn-link" %>
    <% elsif current_user.want_to_you?(@post.user) %>
      <%= link_to '接受好友邀請', friendships_path(friend_id: @post.user), method: :post,class: "btn btn-primary" %>
    <% else %>
      <%= link_to '送出好友邀請', friendships_path(friend_id: @post.user), method: :post,class: "btn btn-primary" %>
    <% end %>

  <% end %>
      
  <p class="text-muted">
    <em><%= time_ago_in_words(@post.created_at) %> ago</em>
    <% if current_user.id == @post.user.id %>
      <em> - </em>
      <%= link_to "編輯", edit_post_path(@post), method: :get %> | 
      <%= link_to "刪除", post_path(@post), method: :delete %>
    <% end %>
  </p>
  <% if not @post.is_favorited?(current_user) %>
    <%= link_to '收藏', favorite_post_path(@post), method: :post, class: "btn btn-primary", data: { :"disable-with" => "Waiting...." } %>
  <% else %>  
    <%= link_to '取消收藏', unfavorite_post_path(@post), method: :post, class: "btn btn-info", data: { :"disable-with" => "Waiting...." } %>
  <% end %>
  <hr>
 </div>
</div>


<div class="container">
  <div class="row">
  
  <!-- 顯示與相關的評論 -->
  <% if params[:page] %>
    <% i = params[:page].to_i * 10 + 1 %>
  <% else %>
    <% i = 1 %>
  <% end %>
  <% @comments.each do |comment| %> 
    <div>
      <h4>#<%= i %> <%= comment.user.name %></h4>
       
      <% if not current_user == comment.user %>
 
        <% if current_user.friend?(comment.user) %>
         
        <% elsif current_user.request_friend?(comment.user) %>
          <%= link_to '取消好友邀請', friendship_path(comment.user), method: :delete, class: "btn btn-link" %>
        <% elsif current_user.want_to_you?(comment.user) %>
          <%= link_to '接受好友邀請', friendships_path(friend_id: comment.user), method: :post,class: "btn btn-primary" %>
        <% else %>
          <%= link_to '送出好友邀請', friendships_path(friend_id: comment.user), method: :post,class: "btn btn-primary" %>
        <% end %>
        
      <% end %>
        
      <p><%= simple_format comment.content %></p>
      <p class="text-muted">
        <em><%= time_ago_in_words(comment.created_at) %> ago</em>
        <% if current_user.id == comment.user.id %>
          <em> - </em>
          <%= link_to "編輯", edit_post_comment_path(@post, comment), remote: true %> | 
          <%= link_to "刪除", post_comment_path(@post, comment), method: :delete %>
        <% end %>
      </p>
    </div>
    <hr>
    <% i = i + 1 %>
  <% end %>

  <%= paginate @comments %> 

  <%= form_for [@post, @comment] do |f| %>
    <div class="form-group">
      <%= f.text_area :content, placeholder: "留個言吧", class: "form-control" %>
    </div>
    <div class="form-group">
      <%= f.submit "留言", class: "btn btn-primary" %>
      <%= f.button "清空", type: :reset, class: "btn btn-default" %>
    </div>
  <% end %>
  </div>
</div>
